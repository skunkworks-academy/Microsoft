<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Skunkworks • AZ-040 Cheat Sheet — Online Hosted Instructions</title>
<style>
:root{--bg:#fcfcfe;--card:#ffffff;--ink:#0b1220;--muted:#5d6b83;--accent:#2563eb;--chip:#eef2ff}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,Helvetica,Arial,sans-serif;color:var(--ink);background:linear-gradient(180deg,var(--bg),#f7faff)}
.container{max-width:1100px;margin:auto;padding:28px}
.header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
.logo{width:36px;height:36px;border-radius:10px;background:#111827;color:#fff;display:grid;place-items:center;font-weight:700}
.brand{font-weight:700;letter-spacing:.3px}
.spacer{flex:1}
.badge{font-weight:600;font-size:12px;color:#1f2937;background:var(--chip);border:1px solid #d1d5ff;padding:6px 10px;border-radius:999px}
.h1{font-size:28px;margin:10px 0 4px 0}
.sub{color:var(--muted);margin:0 0 16px 0}
.card{background:var(--card);border:1px solid #e6eaf5;border-radius:16px;padding:18px;margin:14px 0;box-shadow:0 1px 0 rgba(12,23,41,.03)}
h2{font-size:18px;margin:0 0 8px;color:#0b1220}
p{color:var(--muted);margin:6px 0 12px;line-height:1.55}
ul{margin:0 0 0 20px}
li{margin:6px 0}
.code{background:#0b122005;border:1px solid #e7e9f2;border-radius:12px;padding:12px;overflow:auto}
pre,code{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
.kv{display:flex;gap:8px;flex-wrap:wrap}
.kv span{background:var(--chip);border:1px solid #d1d5ff;border-radius:999px;padding:6px 10px;font-size:12px}
.table{width:100%;border-collapse:collapse}
.table th,.table td{border-bottom:1px solid #edf0f7;padding:10px 8px;text-align:left;vertical-align:top}
.table th{color:#111827}
.two{display:grid;grid-template-columns:1fr 1fr;gap:14px}
@media (max-width:900px){.two{grid-template-columns:1fr}}
.footer{font-size:12px;color:#6b7280;margin-top:14px}
hr{border:0;border-top:1px solid #e6eaf5;margin:18px 0}
kbd{border:1px solid #c7ccdb;border-bottom-width:2px;border-radius:6px;padding:1px 6px;background:#fff;font-size:12px}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="logo">S</div>
    <div>
      <div class="brand">Skunkworks • AZ-040 Revision</div>
      <div class="sub">One-pager: Online Hosted Instructions (Master Guide)</div>
    </div>
    <div class="spacer"></div>
    <span class="badge">2025-08-22</span>
  </div>

  <div class="card">
    <div class="h1">Overview</div>
    <p>Quick master guide for running all hosted AZ‑040 labs in a browser-based environment (Cloud Shell/hosted VM). Includes setup checks, navigation, common commands, troubleshooting, and best practices.</p>
    <div class="kv"><span>Cloud Shell/VM Ready</span><span>PowerShell 7 &amp; 5.1</span><span>Modules: Az, Graph, EXO</span><span>Remoting/WinRM</span></div>
  </div>

  <div class="two">
    <div class="card">
      <h2>Environment Setup (checklist)</h2>
      <ul>
        <li>PowerShell version: <code>$PSVersionTable.PSVersion</code> (prefer 7+; some labs require 5.1)</li>
        <li>Modules: <code>Get-Module -ListAvailable Az, Microsoft.Graph, ExchangeOnlineManagement</code></li>
        <li>Remoting: <code>Test-WSMan</code> to target(s); open TCP 5985/5986 if needed</li>
        <li>Execution policy (session): <code>Set-ExecutionPolicy Bypass -Scope Process</code></li>
        <li>Storage/work path exists (Cloud Shell): <code>Test-Path ~/clouddrive</code></li>
      </ul>
    </div>
    <div class="card">
      <h2>Navigation & Lab Flow</h2>
      <ul>
        <li>Start with <em>Configuring PowerShell</em> → Pipeline → PSProviders/PSDrives</li>
        <li>Then WMI/CIM → Remote Admin → Scripts → Jobs</li>
        <li>Cloud/Admin services: Azure (Az) → Microsoft 365 (Graph/EXO/SPO/Teams)</li>
        <li>Use the individual one‑pagers for copy‑paste blocks and RCA</li>
      </ul>
    </div>
  </div>

  <div class="card">
    <h2>Common Commands (copy &amp; paste)</h2>
<pre class="code"># PowerShell help & discovery
Update-Help -Force
Get-Help Get-Process -Examples
Get-Command -Verb Get -Noun *Service*

# Module installs (current user)
Install-Module Az, Microsoft.Graph, ExchangeOnlineManagement -Scope CurrentUser -Force

# Azure sign-in & context
Connect-AzAccount
Get-AzSubscription | ft Name,Id,State
Set-AzContext -Subscription &lt;SUB_ID&gt;

# Microsoft Graph & services
Connect-MgGraph -Scopes "User.ReadWrite.All,Group.ReadWrite.All,Directory.ReadWrite.All"
Connect-ExchangeOnline
Connect-SPOService -Url "https://&lt;tenant&gt;-admin.sharepoint.com"
Connect-MicrosoftTeams

# Remoting basics
Enable-PSRemoting -Force
Enter-PSSession -ComputerName LON-DC1; Exit-PSSession
Invoke-Command -ComputerName LON-DC1,LON-SVR1 -ScriptBlock { Get-Service }

# Jobs
Start-Job -Name Scan -ScriptBlock { Get-ChildItem E:\ -Recurse -File }
Get-Job; Receive-Job -Name Scan -Keep</pre>
  </div>

  <div class="two">
    <div class="card">
      <h2>Troubleshooting & Root Cause</h2>
      <table class="table">
        <tr><th>Symptom</th><th>Likely Cause → Fix</th></tr>
        <tr><td>Login loops / MFA prompts</td><td>Stale tokens → <code>Disconnect-*</code> then retry; try <code>-UseDeviceAuthentication</code> or different tenant with <code>-Tenant</code>.</td></tr>
        <tr><td>“No subscriptions found”</td><td>Wrong tenant/context → <code>Connect-AzAccount -Tenant &lt;TenantId&gt;</code> then <code>Set-AzContext</code>.</td></tr>
        <tr><td>Module not found</td><td>Missing/blocked install → run elevated or <code>-Scope CurrentUser</code>; check proxy/TLS; <code>Install-Module</code> again.</td></tr>
        <tr><td>Remoting access denied</td><td>WinRM/firewall/rights → <code>Enable-PSRemoting</code>, open 5985/5986, use domain creds, test with <code>Test-WSMan</code>.</td></tr>
        <tr><td>Graph 403 / insufficient privileges</td><td>Missing scopes/consent → add required scopes; ensure admin consent; for app-only, use app registration.</td></tr>
      </table>
    </div>
    <div class="card">
      <h2>Best Practices</h2>
      <ul>
        <li><strong>Filter left, format right:</strong> keep <code>Format-*</code> last.</li>
        <li><strong>Idempotence:</strong> name resources predictably (e.g., <code>YourNameM9</code>), use <code>-WhatIf</code> on destructive cmdlets.</li>
        <li><strong>Security:</strong> prefer Kerberos; document any CredSSP/HTTPS use; avoid storing creds in code.</li>
        <li><strong>Governance:</strong> tag Azure resources; use RBAC and least privilege; log with <code>Start-Transcript</code>.</li>
      </ul>
    </div>
  </div>

  <div class="card">
    <h2>Keyboard Shortcuts</h2>
    <ul>
      <li><kbd>Ctrl</kbd>+<kbd>R</kbd> (PSReadLine): rotate history search</li>
      <li><kbd>Ctrl</kbd>+<kbd>Space</kbd>: IntelliSense (VS Code)</li>
      <li><kbd>Ctrl</kbd>+<kbd>P</kbd>: print to PDF (this page)</li>
    </ul>
  </div>

  <hr>
  <div class="footer">
    Master guide for hosted AZ‑040 labs. Use alongside per‑lab one‑pagers. Print‑friendly • Light theme.
  </div>
</div>
</body>
</html>